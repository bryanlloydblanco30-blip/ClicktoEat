(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11335,e=>{"use strict";let t="http://127.0.0.1:8000";function r(){let e=localStorage.getItem("cart_session_id");return e||(e="session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem("cart_session_id",e)),e}async function s(){let e=await fetch(`${t}/api/menu/`);if(!e.ok)throw Error("Failed to fetch menu items");return e.json()}async function a(){let e=r(),s=await fetch(`${t}/api/cart/?session_id=${e}`);if(!s.ok)throw Error("Failed to fetch cart");return s.json()}async function o(e,s=1){let a=await fetch(`${t}/api/cart/add/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({menu_item_id:e,quantity:s,session_id:r()})});if(!a.ok)throw Error("Failed to add to cart");return a.json()}async function i(e,r){let s=await fetch(`${t}/api/cart/update/${e}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:r})});if(!s.ok)throw Error("Failed to update cart item");return s.json()}async function n(e){let r=await fetch(`${t}/api/cart/remove/${e}/`,{method:"DELETE"});if(!r.ok)throw Error("Failed to remove from cart");return r.json()}async function d(e){let s=await fetch(`${t}/api/favorites/add/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({menu_item_id:e,session_id:r()})});if(!s.ok)throw Error("Failed to add to favorites");return s.json()}async function c(e){let s=r(),a=await fetch(`${t}/api/favorites/remove/?session_id=${s}&menu_item_id=${e}`,{method:"DELETE"});if(!a.ok)throw Error("Failed to remove from favorites");return a.json()}async function l(){let e=r(),s=await fetch(`${t}/api/favorites/?session_id=${e}`);if(!s.ok)throw Error("Failed to fetch favorites");return s.json()}async function m(){let e=r(),s=await fetch(`${t}/api/favorites/ids/?session_id=${e}`);if(!s.ok)throw Error("Failed to fetch favorite IDs");return s.json()}async function h(e){let s=await fetch(`${t}/api/orders/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,session_id:r()})});if(!s.ok)throw Error((await s.json()).error||"Failed to create order");return s.json()}async function u(){let e=r(),s=await fetch(`${t}/api/orders/?session_id=${e}`);if(!s.ok)throw Error("Failed to fetch orders");return s.json()}async function f(){let e=await fetch(`${t}/api/partners/`);if(!e.ok)throw Error("Failed to fetch partners");return e.json()}async function p(e){let r=encodeURIComponent(e),s=await fetch(`${t}/api/partners/${r}/menu/`);if(!s.ok)throw Error("Failed to fetch partner menu");return s.json()}async function g(e,r,s,a="member",o="",i="",n=""){let d=await fetch(`${t}/api/auth/signup/`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:e,email:r,password:s,role:a,food_partner:o,full_name:i,sr_code:n})});if(!d.ok)throw Error((await d.json()).error||"Signup failed");return d.json()}async function x(e,r){let s=await fetch(`${t}/api/auth/login/`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:e,password:r})});if(!s.ok)throw Error((await s.json()).error||"Login failed");return s.json()}e.s(["addFavorite",()=>d,"addToCart",()=>o,"createOrder",()=>h,"getCart",()=>a,"getFavoriteIds",()=>m,"getFavorites",()=>l,"getFoodPartners",()=>f,"getMenuItems",()=>s,"getOrders",()=>u,"getPartnerMenuItems",()=>p,"login",()=>x,"removeFavorite",()=>c,"removeFromCart",()=>n,"signup",()=>g,"updateCartItem",()=>i])},75753,e=>{"use strict";var t=e.i(94862),r=e.i(61374),s=e.i(70441),a=e.i(25721),o=e.i(46317),i=e.i(11335),n=e.i(4125);let d=[{id:0,name:"Cash payment",img:"/payment-method/payment-method.png"},{id:1,name:"gcash",img:"/payment-method/gcash.png"},{id:2,name:"paymaya",img:"/payment-method/maya.png"}];function c(){let e=(0,o.useRouter)(),{showToast:c}=(0,n.useToast)(),[l,m]=(0,s.useState)([]),[h,u]=(0,s.useState)(""),[f,p]=(0,s.useState)(""),[g,x]=(0,s.useState)(0),[y,j]=(0,s.useState)(!1),[b,w]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{try{let e=sessionStorage.getItem("checkout_item_ids");if(!e)return void w(!1);let t=JSON.parse(e),r=(await (0,i.getCart)()).cart.filter(e=>t.includes(e.id));m(r)}catch(e){console.error("Error loading checkout items:",e)}finally{w(!1)}})()},[]);let v=l.reduce((e,t)=>e+parseFloat(t.subtotal),0),N=async()=>{if(!h)return void c("Please select a payment method","red");if(!f)return void c("Please set pickup time","red");j(!0);try{let t=localStorage.getItem("user"),r="Guest";if(t)try{let e=JSON.parse(t);r=e.full_name||e.username||"Guest"}catch(e){console.error("Error parsing user:",e)}let s=await (0,i.createOrder)({payment_method:h,tip:g,pickup_time:f,customer_name:r});s.success&&(c(`Order #${s.order_id} submitted successfully!`,"green"),sessionStorage.removeItem("checkout_item_ids"),window.dispatchEvent(new Event("cartUpdated")),e.push("/"))}catch(t){console.error("Order submission error:",t);let e=t instanceof Error?t.message:"Unknown error occurred";c(`Failed to submit order: ${e}`,"red")}finally{j(!1)}};return b?(0,t.jsx)("main",{className:"min-h-screen p-6",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsx)("p",{className:"text-xl text-gray-600",children:"Loading..."})})}):(0,t.jsxs)("main",{className:"min-h-screen p-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)(r.default,{src:"/shopping-cart.png",height:30,width:30,alt:"shopping cart icon"}),(0,t.jsx)("h1",{className:"ml-3 text-xl md:text-2xl font-semibold",children:"Checkout"})]}),0===l.length?(0,t.jsxs)("section",{className:"flex flex-col items-center",children:[(0,t.jsx)(r.default,{src:"/empty-cart.png",width:200,height:200,alt:"Empty Cart"}),(0,t.jsx)("h2",{className:"text-xl font-semibold mt-4 text-gray-600",children:"No items selected for checkout"}),(0,t.jsx)(a.default,{href:"/mycart",className:"mt-6 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Back to Cart"})]}):(0,t.jsxs)("section",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm space-y-4",children:[(0,t.jsx)("h2",{className:"font-bold text-lg",children:"Order Items"}),l.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center border-b pb-3 last:border-b-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("img",{src:e.image_url||"/placeholder.png",alt:e.name,className:"w-16 h-16 rounded-lg object-cover border"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"font-semibold",children:e.name}),(0,t.jsxs)("p",{className:"text-gray-600 text-sm",children:[e.quantity," x ₱",parseFloat(e.price).toFixed(2)]})]})]}),(0,t.jsxs)("p",{className:"font-semibold text-red-600",children:["₱",parseFloat(e.subtotal).toFixed(2)]})]},e.id))]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,t.jsx)("p",{className:"font-bold text-lg mb-2",children:"Payment Methods"}),(0,t.jsx)("div",{className:"grid gap-3",children:d.map(e=>(0,t.jsxs)("button",{onClick:()=>u(e.name),className:`flex items-center gap-3 w-full p-3 border rounded-lg transition ${h===e.name?"border-red-600 bg-red-50":"border-gray-200 hover:bg-gray-50"}`,children:[(0,t.jsx)(r.default,{src:e.img,alt:e.name,width:40,height:30,className:"object-contain"}),(0,t.jsx)("h3",{className:h===e.name?"text-red-600 font-semibold":"",children:e.name})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"Tip"}),(0,t.jsx)("div",{className:"flex gap-3 mb-2",children:[5,10,20].map(e=>(0,t.jsxs)("button",{className:`px-4 py-2 border rounded-lg transition ${g===e?"border-red-600 bg-red-50 text-red-600":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>x(e),children:["₱",e,".00"]},e))}),(0,t.jsx)("input",{type:"number",placeholder:"Custom Tip",className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-red-600",value:g||"",min:0,onChange:e=>x(Number(e.target.value)),onKeyDown:e=>{("-"===e.key||"e"===e.key)&&e.preventDefault()}})]})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[(0,t.jsx)("h1",{className:"font-semibold text-lg",children:"Time of Pickup"}),(0,t.jsx)("input",{type:"datetime-local",className:"border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-red-600",value:f,onChange:e=>p(e.target.value)})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Subtotal: ₱",v.toFixed(2)]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Tip: ₱",g.toFixed(2)]}),(0,t.jsxs)("p",{className:"font-bold text-xl text-red-600 mt-1",children:["Total: ₱",(v+g).toFixed(2)]})]}),(0,t.jsx)("button",{className:"bg-red-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-red-700 transition disabled:opacity-50",onClick:N,disabled:y,children:y?"Processing...":"Confirm Order"})]})]})]})}e.s(["default",()=>c])}]);